<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SIBALEONE Metal Minting - Luca Urbani</title>

  <!-- ===== Inlined styles (single file copy-paste) ===== -->
  <style>
    :root{
      --accent:#8B4513;
      --bg:#f9f5f0;
      --lightbox-bg:rgba(0,0,0,0.98);
    }
    *{box-sizing:border-box}
    body{font-family:Arial, sans-serif; margin:0; background:var(--bg); color:#333; line-height:1.6}

    header{
      background: url('media/Lion Header.jpg') center/cover no-repeat;
      height:100dvh; min-height:1050px;
      display:flex; flex-direction:column; justify-content:center; align-items:center;
      position:relative; padding:20px; text-align:center;
    }
    header::before{content:''; position:absolute; inset:0; background:rgba(0,0,0,0.62)}
    header>div{position:relative; z-index:2; color:white; max-width:95%}
    header h1{font-size:clamp(3.2rem,11vw,7rem); margin:0 0 20px; text-shadow:4px 4px 20px #000; letter-spacing:3px}
    header p{font-size:clamp(1.4rem,4.5vw,2.3rem); text-shadow:3px 3px 15px #000; letter-spacing:1.5px}

    nav{background:#A0522D; padding:15px; text-align:center; position:sticky; top:0; z-index:1000}
    nav a{color:white; margin:0 20px; text-decoration:none; font-weight:bold; font-size:1.1em}

    section{padding:60px 20px; text-align:center}
    h1,h2,h3{color:var(--accent)}

    .gallery{display:flex; flex-wrap:wrap; gap:22px; justify-content:center; padding:20px}
    .photo-wrapper{position:relative; width:310px; cursor:zoom-in; outline: none;}
    .photo-wrapper:focus{box-shadow:0 0 0 4px rgba(139,69,19,0.12); border-radius:12px}
    .gallery img{width:100%; height:auto; border:5px solid var(--accent); border-radius:12px; transition:transform .2s}
    .gallery img:hover{transform:scale(1.04)}
    .caption{
      position:absolute; top:0; left:0; width:100%;
      background:rgba(0,0,0,0.78); color:white; padding:12px 8px;
      font-weight:bold; font-size:.95em; text-align:center;
      border-top-left-radius:10px; border-top-right-radius:10px;
    }

    .featured{display:flex; flex-wrap:wrap; gap:40px; justify-content:center; margin-top:50px}
    .featured .photo-wrapper{width:300px; height:300px; border-radius:50%; overflow:hidden; cursor:zoom-in;
      border:8px solid var(--accent); box-shadow:0 10px 30px rgba(0,0,0,0.3)}
    .featured img{width:100%; height:100%; object-fit:cover}

    .contact-container{display:flex; align-items:center; justify-content:center; gap:50px; flex-wrap:wrap; max-width:1000px; margin:0 auto}
    .contact-photo{width:240px; height:240px; border-radius:50%; object-fit:cover; border:7px solid var(--accent); box-shadow:0 8px 25px rgba(0,0,0,0.4)}
    .email{font-size:1.6em; font-weight:bold; color:var(--accent)}

    /* LIGHTBOX */
    #lightbox{
      display:none; position:fixed; inset:0; z-index:9999;
      background:var(--lightbox-bg); overflow:hidden; justify-content:center; align-items:center;
      cursor:grab;
    }
    #lightbox.dragging{cursor:grabbing}
    #lightbox-img{
      max-width:95vw; max-height:95vh;
      border:7px solid var(--accent); border-radius:14px;
      box-shadow:0 0 40px rgba(0,0,0,0.9);
      user-select:none; touch-action:none;
      transform: translate(var(--pan-x,0px), var(--pan-y,0px)) scale(var(--scale,1));
      transition:none;
      will-change:transform;
    }

    /* control buttons */
    .lb-control{
      position:fixed; z-index:10000; display:flex; align-items:center; justify-content:center;
      background:transparent; border:0; color:white; cursor:pointer;
      padding:6px; opacity:.9;
    }
    .close-btn{
      right:30px; top:15px; font-size:54px; font-weight:700;
    }
    .nav-arrow{
      top:50%; transform:translateY(-50%); font-size:0; /* hide text fallback */
      width:70px; height:70px; border-radius:12px; background:rgba(0,0,0,0.3);
      display:flex; align-items:center; justify-content:center; backdrop-filter:blur(4px);
    }
    .prev-arrow{left:20px}
    .next-arrow{right:20px}
    .nav-arrow svg{width:46px;height:46px; color:white; filter:drop-shadow(0 4px 20px rgba(0,0,0,.6))}

    /* rotate button (uses SVG now - GIF removed completely) */
    .rotate-btn{
      position:fixed; right:30px; bottom:30px; z-index:10000;
      width:64px; height:64px; padding:8px; border-radius:12px; background:rgba(255,255,255,0.04);
      display:flex; align-items:center; justify-content:center; border:1px solid rgba(255,255,255,0.06);
    }
    .rotate-btn svg{width:40px; height:40px; color:white; filter:drop-shadow(0 0 6px rgba(0,0,0,0.6))}

    /* Video section styles (YouTube embed) */
    .video-card { display:inline-block; max-width:920px; width:100%; margin:0 auto; cursor:pointer; outline:none; }
    .video-thumb {
      width:100%; max-width:920px; aspect-ratio:16/9;
      background-size:cover; background-position:center;
      border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,0.25);
      display:flex; align-items:center; justify-content:center; position:relative;
      border:5px solid var(--accent);
    }
    .play-btn { background:transparent; border:0; padding:0; cursor:pointer; display:flex; align-items:center; justify-content:center; }
    .play-btn svg { filter: drop-shadow(0 6px 18px rgba(0,0,0,0.6)); transform:translateY(0); transition:transform .12s ease; }

    .video-modal {
      display:none; position:fixed; inset:0; z-index:15000;
      background:rgba(0,0,0,0.92);
      align-items:center; justify-content:center; padding:24px;
    }
    .video-modal[aria-hidden="false"]{ display:flex; }

    .video-close {
      position:fixed; top:18px; right:22px; z-index:15010;
      font-size:48px; color:#fff; background:transparent; border:0; cursor:pointer;
      padding:6px; line-height:1;
    }
    .video-frame { width:100%; max-width:1200px; }
    .video-caption { color:#fff; margin-top:12px; font-size:0.95rem; text-align:center; opacity:0.95; }

    footer{
      background:url('media/Lion Greek plus mans.png') center/cover no-repeat;
      height:380px; display:flex; flex-direction:column; justify-content:flex-end;
      position:relative; color:white;
    }
    footer::before{content:''; position:absolute; inset:0; background:rgba(0,0,0,0.68)}
    footer>div{position:relative; z-index:2; text-align:center; padding:30px; background:rgba(139,69,19,0.75)}

    @media (max-width:520px){
      .photo-wrapper{width:46vw}
      .nav-arrow{width:56px;height:56px}
      .rotate-btn{width:56px;height:56px}
    }
  </style>
</head>
<body>

  <header>
    <div>
      <h1>SIBALEONE Metal Minting</h1>
      <p>From the heart of a star to the strike of my hammer, creation is never easy.
I confront fear as a warrior does—and each challenge hardens my spirit.</p>
    </div>
  </header>

  <nav>
    <a href="#about">About</a>
    <a href="#photos">Gallery</a>
    <a href="#contact">Contact</a>
  </nav>

  <section id="about">
    <h2>About Luca Urbani — SIBALEONE</h2>
    <p>I am a blacksmith with a passion for working with metal in all its forms…</p>
    <h3>Featured work</h3>
    <div class="featured">
      <div class="photo-wrapper"><img src="media/13.jpg" alt=""></div>
      <div class="photo-wrapper"><img src="media/26.jpg" alt=""></div>
      <div class="photo-wrapper"><img src="media/24.png" alt=""></div>
    </div>
  </section>

  <section id="photos">
    <h2>The recycling of metal</h2>
    <div class="gallery">
      <div class="photo-wrapper"><img src="media/1.1.jpg" alt=""><div class="caption">The fire</div></div>
      <div class="photo-wrapper"><img src="media/1.jpg" alt=""><div class="caption">Fire ready</div></div>
      <div class="photo-wrapper"><img src="media/2.1.png" alt=""><div class="caption">Raw material (copper wires top quality)</div></div>
      <div class="photo-wrapper"><img src="media/2.jpg" alt=""><div class="caption">Raw material (pipes second quality)</div></div>
      <div class="photo-wrapper"><img src="media/4.jpg" alt=""><div class="caption">Crucible cooling out of gas :(</div></div>
      <div class="photo-wrapper"><img src="media/5.jpeg" alt=""><div class="caption">Heating pipes to remove contaminants</div></div>
      <div class="photo-wrapper"><img src="media/6.jpeg" alt=""><div class="caption">Inspecting the GOODS</div></div>
      <div class="photo-wrapper"><img src="media/7.1.jpeg" alt=""><div class="caption">Copper coins after striking (not polished yet)</div></div>
      <div class="photo-wrapper"><img src="media/7.jpg" alt=""><div class="caption">Copper bars before polishing</div></div>
      <div class="photo-wrapper"><img src="media/8.1.jpeg" alt=""><div class="caption">Close-up detail after polishing</div></div>
      <div class="photo-wrapper"><img src="media/8.2.jpg" alt=""><div class="caption">Grabbing the goods</div></div>
      <div class="photo-wrapper"><img src="media/8.3.jpeg" alt=""><div class="caption">Copper and Gold</div></div>
      <div class="photo-wrapper"><img src="media/8.jpg" alt=""><div class="caption">Gently buffing Gold bar</div></div>
      <div class="photo-wrapper"><img src="media/10.1.jpeg" alt=""><div class="caption">Copper Marvel</div></div>
      <div class="photo-wrapper"><img src="media/10.jpeg" alt=""><div class="caption">Copper Marvel (Close-up)</div></div>
      <div class="photo-wrapper"><img src="media/11.1.jpeg" alt=""><div class="caption">All unique art pieces</div></div>
      <div class="photo-wrapper"><img src="media/12.jpeg" alt=""><div class="caption">Coin ready for shipping</div></div>
      <div class="photo-wrapper"><img src="media/13.1.jpg" alt=""><div class="caption">Weighting the coin</div></div>
      <div class="photo-wrapper"><img src="media/13.jpg" alt=""><div class="caption">Bars and coins ready for inspection</div></div>
      <div class="photo-wrapper"><img src="media/18.jpg" alt=""><div class="caption">Raising the bar</div></div>
      <div class="photo-wrapper"><img src="media/19.jpeg" alt=""><div class="caption">Metal stamp</div></div>
      <div class="photo-wrapper"><img src="media/20.jpeg" alt=""><div class="caption">Business card</div></div>
      <div class="photo-wrapper"><img src="media/22.jpg" alt=""><div class="caption">Bars ready for selling</div></div>
      <div class="photo-wrapper"><img src="media/Stacked Stamped Bars.png" alt=""><div class="caption">STAMPED BARS ready for delivery</div></div>
      <div class="photo-wrapper"><img src="media/23.png" alt=""><div class="caption">Contract for Pi Network DONE</div></div>
      <div class="photo-wrapper"><img src="media/24.png" alt=""><div class="caption">Pi Network coin (made in 2024)</div></div>
      <div class="photo-wrapper"><img src="media/25.jpg" alt=""><div class="caption">Methodology for Pi project</div></div>
      <div class="photo-wrapper"><img src="media/26.jpg" alt=""><div class="caption">Hand and feet of my newborn son in PURE METAL</div></div>
    </div>
  </section>

  <!-- Video section: YouTube Short embed (opens modal and plays the short) -->
  <section id="video" aria-labelledby="video-title" style="padding:60px 20px; text-align:center;">
    <h2 id="video-title" style="color:#8B4513; margin-bottom:18px;">Watch the Process</h2>

    <!-- Card-style thumbnail that opens the modal player -->
    <div class="video-card" role="button" tabindex="0" aria-pressed="false" aria-label="Open video player">
      <div class="video-thumb" style="background-image:url('media/6.jpeg')">
        <button class="play-btn" aria-hidden="true">
          <!-- Crisp SVG play icon -->
          <svg viewBox="0 0 64 64" width="60" height="60" aria-hidden="true" focusable="false">
            <circle cx="32" cy="32" r="30" fill="rgba(0,0,0,0.55)"/>
            <path d="M26 20 L46 32 L26 44 z" fill="#fff"/>
          </svg>
        </button>
      </div>
      <figcaption style="margin-top:12px; font-weight:bold; color:#333;">Forging a Copper Coin (YouTube Short)</figcaption>
    </div>

    <!-- Modal / Lightbox video player (hidden by default) -->
    <div id="video-modal" class="video-modal" aria-hidden="true" role="dialog" aria-label="Video player">
      <button id="video-close" class="video-close" aria-label="Close video (Esc)">×</button>

      <div class="video-frame" role="document">
        <div style="width:100%; max-width:1200px; aspect-ratio:16/9; margin:0 auto;">
          <iframe id="video-iframe"
                  src=""
                  width="100%" height="100%"
                  frameborder="0"
                  allow="autoplay; encrypted-media; accelerometer; clipboard-write; gyroscope; picture-in-picture"
                  allowfullscreen
                  title="Forging a Copper Coin - YouTube Short"
                  style="width:100%; height:100%; border-radius:10px; display:block;"></iframe>
        </div>

        <div class="video-caption" id="video-desc" style="color:#fff; margin-top:12px; text-align:center; opacity:0.95;">
          Short studio clip: heating, striking and finishing copper bullion bars.
        </div>
      </div>
    </div>

    <script>
      (function(){
        // You provided this YouTube short link: https://youtube.com/shorts/uyvbG2ZGDWg?feature=share
        const VIDEO_ID = 'uyvbG2ZGDWg';
        const YT_EMBED_BASE = 'https://www.youtube-nocookie.com/embed/';

        const card = document.querySelector('.video-card');
        const modal = document.getElementById('video-modal');
        const iframe = document.getElementById('video-iframe');
        const closeBtn = document.getElementById('video-close');

        if (!card || !modal || !iframe) return;

        function buildSrc() {
          // autoplay=1 attempts to start playback; playsinline=1 helps mobile inline playback
          return `${YT_EMBED_BASE}${VIDEO_ID}?autoplay=1&modestbranding=1&rel=0&playsinline=1`;
        }

        function openVideo() {
          iframe.src = buildSrc();
          modal.style.display = 'flex';
          modal.setAttribute('aria-hidden','false');
          document.body.style.overflow = 'hidden';
          // On small touch devices, try fullscreen for immersive viewing
          const isTouch = (navigator.maxTouchPoints && navigator.maxTouchPoints > 0) || ('ontouchstart' in window);
          const minDim = Math.min(window.innerWidth || screen.width, window.innerHeight || screen.height);
          if (isTouch && minDim <= 820) {
            if (modal.requestFullscreen) modal.requestFullscreen().catch(()=>{});
            else if (modal.webkitRequestFullscreen) modal.webkitRequestFullscreen();
          }
        }

        function closeVideo() {
          modal.style.display = 'none';
          modal.setAttribute('aria-hidden','true');
          document.body.style.overflow = '';
          // Remove src to stop playback and free resources
          iframe.src = '';
          if (document.fullscreenElement || document.webkitFullscreenElement) {
            if (document.exitFullscreen) document.exitFullscreen().catch(()=>{});
            else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
          }
        }

        card.addEventListener('click', openVideo);
        card.addEventListener('keydown', e => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openVideo(); }});
        closeBtn.addEventListener('click', closeVideo);

        // Close when clicking outside the video frame
        modal.addEventListener('click', e => {
          const frame = e.target.closest('.video-frame');
          if (!frame) closeVideo();
        });

        // Keyboard support while modal open
        document.addEventListener('keydown', e => {
          if (modal.getAttribute('aria-hidden') === 'true') return;
          if (e.key === 'Escape') closeVideo();
        });

        // Defensive: clear src when tab hidden to stop playback
        document.addEventListener('visibilitychange', () => {
          if (document.hidden && modal.getAttribute('aria-hidden') === 'false') {
            iframe.src = '';
          }
        });
      })();
    </script>
  </section>

  <section id="contact">
    <h2>Contact</h2>
    <div class="contact-container">
      <img src="media/Luca.jpg" alt="Luca Urbani" class="contact-photo" />
      <div class="contact-text">
        <p>If you'd like to share your minting stories, ask questions, or collaborate, feel free to reach out:</p>
        <p><strong>Phone:</strong> 418.376.7316</p>
        <p class="email">urbani.luca639@gmail.com</p>
      </div>
    </div>
  </section>

  <!-- LIGHTBOX -->
  <div id="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
    <button class="lb-control close-btn" id="lb-close" aria-label="Close (Esc)">×</button>

    <button class="lb-control nav-arrow prev-arrow" id="lb-prev" aria-label="Previous (Left)">
      <svg viewBox="0 0 24 24" aria-hidden="true" fill="currentColor"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
    </button>

    <button class="lb-control nav-arrow next-arrow" id="lb-next" aria-label="Next (Right)">
      <svg viewBox="0 0 24 24" aria-hidden="true" fill="currentColor"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg>
    </button>

    <!-- rotate control: replaced GIF with crisp SVG so no GIFs remain on site -->
    <button class="rotate-btn" id="lb-rotate" aria-label="Rotate image (R)">
      <svg viewBox="0 0 24 24" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 12a9 9 0 1 0-3.1 6.36"/>
        <path d="M21 3v6h-6"/>
      </svg>
    </button>

    <img id="lightbox-img" src="" alt="" draggable="false" />
  </div>

  <footer>
    <div>
      <p style="margin:0;font-size:1.1rem;font-weight:bold;text-shadow:2px 2px 8px #000;">
        © 2025 SIBALEONE Metal Minting — Hand-forged by Luca Urbani<br />All rights reserved
      </p>
    </div>
  </footer>

  <!-- ===== Inlined script (single-file beginner-friendly) ===== -->
  <script>
    /****************************************************************
     * lightbox (single-file beginner-friendly)
     *
     * Behavior:
     * - The tilt/rotate GIF has been removed entirely from the page.
     * - Lightbox works on desktop/tablet/phone: click thumbnail to open.
     * - On small touch phones the script will request fullscreen; no GIFs are used anywhere.
     * - Lightbox: previous/next, keyboard controls, wheel zoom, pan (mouse/touch),
     *   pinch-to-zoom, rotate button rotates 90deg per click (SVG icon used).
     ****************************************************************/

    (function () {
      // ---- Helper detection for phone-like touch devices (used only for fullscreen decision) ----
      function hasTouchSupport() {
        return (navigator.maxTouchPoints && navigator.maxTouchPoints > 0) ||
          ('ontouchstart' in window) ||
          (window.matchMedia && window.matchMedia('(any-pointer: coarse)').matches);
      }
      function uaLooksLikeMobile() {
        return /Mobi|Android|Silk|iPhone|iPod|iPad|Phone/i.test(navigator.userAgent || '');
      }
      function isPhone() {
        const minDim = Math.min(window.innerWidth || screen.width, window.innerHeight || screen.height);
        const maxDim = Math.max(window.innerWidth || screen.width, window.innerHeight || screen.height);
        const smallViewport = (minDim <= 820) || (maxDim <= 900);
        return hasTouchSupport() && (smallViewport || uaLooksLikeMobile());
      }

      // ---- Lightbox core ----
      const lightbox = document.getElementById('lightbox');
      const lbImg = document.getElementById('lightbox-img');
      const photos = Array.from(document.querySelectorAll('.photo-wrapper'));
      const closeBtn = document.getElementById('lb-close');
      const prevBtn = document.getElementById('lb-prev');
      const nextBtn = document.getElementById('lb-next');
      const rotateBtn = document.getElementById('lb-rotate');

      if (!lightbox || !lbImg || photos.length === 0) return;

      let current = 0;
      let scale = 1, panX = 0, panY = 0, rotation = 0;
      let isDragging = false, startX = 0, startY = 0, startDist = 0;
      function updateTransform() {
        lbImg.style.setProperty('--scale', scale);
        lbImg.style.setProperty('--pan-x', panX + 'px');
        lbImg.style.setProperty('--pan-y', panY + 'px');
        lbImg.style.transform = `translate(var(--pan-x,0px), var(--pan-y,0px)) scale(var(--scale,1)) rotate(${rotation}deg)`;
      }

      function requestFullscreenIfAppropriate(el) {
        if (!isPhone()) return;
        if (!el) return;
        if (el.requestFullscreen) el.requestFullscreen().catch(()=>{});
        else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
        else if (el.msRequestFullscreen) el.msRequestFullscreen();
      }

      function openAt(i) {
        const wrapper = photos[i];
        if (!wrapper) return;
        const img = wrapper.querySelector('img');
        current = i;
        lbImg.src = img.dataset.full || img.src;
        lbImg.alt = img.alt || '';
        scale = 1; panX = 0; panY = 0; rotation = 0;
        updateTransform();
        lightbox.style.display = 'flex';
        lightbox.setAttribute('aria-hidden','false');
        document.body.style.overflow = 'hidden';
        requestFullscreenIfAppropriate(lightbox);
      }

      function closeLightbox() {
        lightbox.style.display = 'none';
        lightbox.setAttribute('aria-hidden','true');
        document.body.style.overflow = '';
        if (document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement) {
          if (document.exitFullscreen) document.exitFullscreen().catch(()=>{});
          else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
        }
      }

      function showIndex(i) {
        current = (i + photos.length) % photos.length;
        const img = photos[current].querySelector('img');
        lbImg.src = img.dataset.full || img.src;
        lbImg.alt = img.alt || '';
        scale = 1; panX = 0; panY = 0; rotation = 0;
        updateTransform();
      }

      // Attach thumbnail handlers
      photos.forEach((wrapper, i) => {
        wrapper.setAttribute('tabindex','0');
        wrapper.style.cursor = 'zoom-in';
        wrapper.addEventListener('click', () => openAt(i));
        wrapper.addEventListener('keydown', e => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openAt(i); }});
      });

      // Close on backdrop or close button
      lightbox.addEventListener('click', e => { if (e.target === lightbox || e.target === closeBtn) closeLightbox(); });
      closeBtn.addEventListener('click', closeLightbox);

      // Prev / Next
      prevBtn.addEventListener('click', () => showIndex(current - 1));
      nextBtn.addEventListener('click', () => showIndex(current + 1));

      // Keyboard support
      document.addEventListener('keydown', e => {
        if (lightbox.style.display !== 'flex') return;
        if (e.key === 'Escape') { closeLightbox(); }
        if (e.key === 'ArrowLeft') prevBtn.click();
        if (e.key === 'ArrowRight') nextBtn.click();
        if (e.key === 'r' || e.key === 'R') { rotation = (rotation + 90) % 360; updateTransform(); }
        if (e.key === '+' || e.key === '=') { scale = Math.min(scale * 1.1, 8); updateTransform(); }
        if (e.key === '-') { scale = Math.max(scale / 1.1, 0.5); updateTransform(); }
      });

      // Wheel zoom
      lbImg.addEventListener('wheel', e => {
        if (lightbox.style.display !== 'flex') return;
        e.preventDefault();
        scale *= e.deltaY > 0 ? 0.9 : 1.1;
        scale = Math.max(0.5, Math.min(scale, 8));
        updateTransform();
      }, { passive: false });

      // Mouse pan (drag)
      lbImg.addEventListener('mousedown', e => {
        if (e.button !== 0) return;
        e.preventDefault();
        isDragging = true;
        startX = e.clientX - panX;
        startY = e.clientY - panY;
        lightbox.classList.add('dragging');
      });
      document.addEventListener('mousemove', e => {
        if (!isDragging) return;
        panX = e.clientX - startX;
        panY = e.clientY - startY;
        updateTransform();
      });
      document.addEventListener('mouseup', () => {
        isDragging = false;
        lightbox.classList.remove('dragging');
      });

      // Touch: pan and pinch-to-zoom
      lightbox.addEventListener('touchstart', e => {
        if (e.touches.length === 2) {
          startDist = Math.hypot(e.touches[0].pageX - e.touches[1].pageX, e.touches[0].pageY - e.touches[1].pageY);
        } else if (e.touches.length === 1) {
          startX = e.touches[0].clientX - panX;
          startY = e.touches[0].clientY - panY;
        }
      }, { passive: true });

      lightbox.addEventListener('touchmove', e => {
        if (e.touches.length === 2) {
          e.preventDefault();
          const dist = Math.hypot(e.touches[0].pageX - e.touches[1].pageX, e.touches[0].pageY - e.touches[1].pageY);
          if (startDist > 0) {
            scale = scale * (dist / startDist);
            scale = Math.max(0.5, Math.min(scale, 8));
            startDist = dist;
            updateTransform();
          }
        } else if (e.touches.length === 1) {
          e.preventDefault();
          panX = e.touches[0].clientX - startX;
          panY = e.touches[0].clientY - startY;
          updateTransform();
        }
      }, { passive: false });

      lightbox.addEventListener('touchend', e => {
        if (e.touches.length < 2) startDist = 0;
      });

      // Rotate button: 90deg CW each click
      rotateBtn.addEventListener('click', () => {
        rotation = (rotation + 90) % 360;
        updateTransform();
      });

      // Double-click / double-tap to toggle reset / zoom
      let lastTap = 0;
      lbImg.addEventListener('dblclick', () => { scale = 1; panX = 0; panY = 0; rotation = 0; updateTransform(); });
      lightbox.addEventListener('touchend', (e) => {
        const now = Date.now();
        if (now - lastTap < 300) {
          if (scale > 1) { scale = 1; panX = 0; panY = 0; }
          else { scale = 2; }
          updateTransform();
        }
        lastTap = now;
      });

      // Fallback: if any gallery image fails to load, replace with a simple SVG "image not found"
      photos.forEach(p => {
        const img = p.querySelector('img');
        img.addEventListener('error', () => {
          img.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="800" height="500"><rect width="100%" height="100%" fill="%23efe8df"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="%238B4513" font-family="Arial, sans-serif" font-size="28">Image not found</text></svg>';
        });
      });

      // expose helpers for debugging in console (optional)
      window._sibaleone = {
        openAt, closeLightbox, showIndex, isPhone: isPhone
      };
    })();
  </script>
</body>
</html>
